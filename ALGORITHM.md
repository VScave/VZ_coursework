# Алгоритм прогнозирования качества сдачи экзаменов

## Описание

Алгоритм прогнозирования использует исторические данные студента для предсказания успешности сдачи предстоящего экзамена. Прогноз основан на трех ключевых факторах: текущие оценки, посещаемость занятий и выполнение домашних заданий.

## Исходные данные

Для расчета прогноза используются следующие данные из базы данных:

- **Оценки (grade)** - текущие оценки студента по предметам (от 1 до 5)
- **Посещаемость (attendance_percent)** - процент посещенных занятий (от 0 до 100%)
- **Выполнение заданий (assignment_completion)** - процент выполненных домашних заданий (от 0 до 100%)

## Этапы работы алгоритма

### Этап 1: Сбор данных

Алгоритм получает все оценки студента из таблицы `student_grades` по его `student_id`:

```cpp
std::vector<Grade> grades = getStudentGrades(student_id);
```

Если у студента нет оценок, возвращается сообщение: *"Недостаточно данных для прогноза"*

### Этап 2: Вычисление средних значений

Для каждого из трех показателей вычисляется среднее арифметическое по всем предметам:

```cpp
avgGrade = (grade₁ + grade₂ + ... + gradeₙ) / n
avgAttendance = (attendance₁% + attendance₂% + ... + attendanceₙ%) / n
avgAssignment = (assignment₁% + assignment₂% + ... + assignmentₙ%) / n
```

где `n` - количество записей об оценках студента.

**Пример:**
- Оценки: [4, 5, 4] → avgGrade = 4.33
- Посещаемость: [85%, 95%, 80%] → avgAttendance = 86.67%
- Выполнение заданий: [90%, 100%, 85%] → avgAssignment = 91.67%

### Этап 3: Расчет прогнозного балла

Прогнозный балл вычисляется по взвешенной формуле:

```
prediction_score = (avgGrade × 0.5) + (avgAttendance / 20.0 × 0.25) + (avgAssignment / 20.0 × 0.25)
```

**Объяснение формулы:**

1. **Средняя оценка (вес 50%)** - основной показатель успеваемости
   - Умножается на 0.5 (50% веса)
   - Уже находится в диапазоне 1-5

2. **Посещаемость (вес 25%)** - показатель регулярности посещения
   - Процент (0-100%) делится на 20, чтобы преобразовать в оценку (0-5)
   - Умножается на 0.25 (25% веса)

3. **Выполнение заданий (вес 25%)** - показатель ответственности
   - Процент (0-100%) делится на 20, чтобы преобразовать в оценку (0-5)
   - Умножается на 0.25 (25% веса)

**Пример расчета:**

При значениях:
- avgGrade = 4.33
- avgAttendance = 86.67%
- avgAssignment = 91.67%

Расчет:
```
prediction_score = (4.33 × 0.5) + (86.67 / 20.0 × 0.25) + (91.67 / 20.0 × 0.25)
                 = 2.165 + (4.33 × 0.25) + (4.58 × 0.25)
                 = 2.165 + 1.08 + 1.145
                 = 4.39
```

### Этап 4: Определение прогнозируемой оценки

На основе `prediction_score` определяется прогнозируемая оценка:

| Диапазон prediction_score | Прогнозируемая оценка |
|---------------------------|----------------------|
| ≥ 4.5                     | **Отлично (5)**      |
| 3.5 ≤ score < 4.5         | **Хорошо (4)**       |
| 2.5 ≤ score < 3.5         | **Удовлетворительно (3)** |
| < 2.5                     | **Неудовлетворительно (2)** |

### Этап 5: Вычисление вероятности

Для каждой оценки вычисляется вероятность (в процентах):

- **Оценка 5 (отлично):** `(prediction_score × 20)%`
- **Оценка 4 (хорошо):** `(prediction_score × 20)%`
- **Оценка 3 (удовлетворительно):** `(prediction_score × 18)%`
- **Оценка 2 (неудовлетворительно):** `((5.0 - prediction_score) × 15)%`

## Примеры работы алгоритма

### Пример 1: Отличный студент

**Данные:**
- Средняя оценка: 5.0
- Посещаемость: 100%
- Выполнение заданий: 100%

**Расчет:**
```
prediction_score = (5.0 × 0.5) + (100/20 × 0.25) + (100/20 × 0.25)
                 = 2.5 + 1.25 + 1.25
                 = 5.0
```

**Результат:** Отлично (5) - вероятность: 100%

### Пример 2: Хороший студент

**Данные:**
- Средняя оценка: 4.0
- Посещаемость: 85%
- Выполнение заданий: 90%

**Расчет:**
```
prediction_score = (4.0 × 0.5) + (85/20 × 0.25) + (90/20 × 0.25)
                 = 2.0 + 1.06 + 1.125
                 = 4.185
```

**Результат:** Хорошо (4) - вероятность: 83%

### Пример 3: Студент с проблемами

**Данные:**
- Средняя оценка: 2.5
- Посещаемость: 60%
- Выполнение заданий: 65%

**Расчет:**
```
prediction_score = (2.5 × 0.5) + (60/20 × 0.25) + (65/20 × 0.25)
                 = 1.25 + 0.75 + 0.8125
                 = 2.81
```

**Результат:** Удовлетворительно (3) - вероятность: 50%

## Особенности алгоритма

### Преимущества

1. **Простота** - алгоритм легко понять и модифицировать
2. **Быстрота** - расчет выполняется мгновенно
3. **Прозрачность** - все факторы влияния понятны
4. **Гибкость** - легко изменить веса факторов

### Ограничения

1. **Упрощенная модель** - не учитывает множество факторов (сложность предмета, предыдущий опыт и т.д.)
2. **Линейная зависимость** - предполагает линейную связь между факторами и результатом
3. **Одинаковые веса для всех предметов** - не учитывает специфику разных дисциплин
4. **Нет учета временных трендов** - не учитывается улучшение/ухудшение успеваемости со временем

## Возможные улучшения

1. **Дифференцированные веса** - разные веса для разных предметов
2. **Временные тренды** - учет улучшения/ухудшения успеваемости
3. **Машинное обучение** - использование ML-моделей для более точного прогноза
4. **Дополнительные факторы** - учет сложности предмета, преподавателя, времени суток экзамена и т.д.

## Реализация в коде

Функция `predictExamSuccess()` находится в файле `backend/database.cpp` (строки 299-344).

**Основной код:**
```cpp
std::string Database::predictExamSuccess(int student_id) {
    // 1. Получение данных
    std::vector<Grade> grades = getStudentGrades(student_id);
    
    // 2. Вычисление средних
    double avgGrade = 0.0;
    double avgAttendance = 0.0;
    double avgAssignment = 0.0;
    // ... расчет средних значений ...
    
    // 3. Расчет прогнозного балла
    double prediction_score = (avgGrade * 0.5) + 
                             (avgAttendance / 20.0 * 0.25) + 
                             (avgAssignment / 20.0 * 0.25);
    
    // 4. Определение оценки и вероятности
    // ... возврат результата ...
}
```

## Использование

Прогноз доступен через API endpoint:
```
GET /api/predict?session_id=<session_id>&student_id=<student_id>
```

Или через веб-интерфейс на главной странице:
1. Выберите студента из списка
2. Нажмите кнопку "Получить прогноз"
3. Система покажет прогнозируемую оценку и вероятность

